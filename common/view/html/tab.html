<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <link rel="icon" href="http://127.0.0.1:8023/static/image/img.png" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>GGT</title>
    <link rel="stylesheet" href="/static/js/layui-v2.6.8/css/layui.css">
    <link rel="stylesheet" href="/static/css/config.css">
    <style>
        /*body {
            background-color: #333 !important;
            line-height: 1.6;
            color: #fff !important;
            font: 14px Helvetica Neue,Helvetica,PingFang SC,Tahoma,Arial,sans-serif;
        }*/
        .layui-tab-content {
            padding: 0px 0 !important;
        }
        /*.layui-tab {
            background-color: #333 !important;
            margin: 10px 0;
            text-align: left !important;
        }*/
        .layui-badge-rim, .layui-border, .layui-colla-content, .layui-colla-item, .layui-collapse, .layui-elem-field, .layui-form-pane .layui-form-item[pane], .layui-form-pane .layui-form-label, .layui-input, .layui-layedit, .layui-layedit-tool, .layui-panel, .layui-quote-nm, .layui-select, .layui-tab-bar, .layui-tab-card, .layui-tab-title, .layui-tab-title .layui-this:after, .layui-textarea {
            border-color: #FFB6C1 !important;
        }
        .layui-layer-title {
            padding: 0 80px 0 20px;
            height: 50px;
            line-height: 50px;
            border-bottom: 1px solid #F0F0F0;
            background-color: #393D49;
            font-size: 14px;
            color: #E6E6FA !important;
            overflow: hidden;
            border-radius: 2px 2px 0 0;
        }

        .layui-layer-setwin .layui-layer-close2 {
            position: absolute;
            right: -4px !important;
            top: -7px !important;
            width: 30px;
            height: 30px;
            margin-left: 0;
            background-position: -149px -31px;
            *right: -18px;
            _display: none;
        }
    </style>
</head>
<body>
<div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
    <ul class="layui-tab-title" style="width: 1000px;margin: 0 auto;">
        <li class="layui-this"><i class="layui-icon layui-icon-email"></i> 邮件附件下载</li>
        <li><i class="layui-icon layui-icon-form"></i> EFC操作流程</li>
    </ul>
    <div class="layui-tab-content" style="height: 100px;">
        <div class="layui-tab-item layui-show">
            <iframe id="iframe1" src="http://127.0.0.1:8023/download" width="100%" style="border: none;"></iframe>
        </div>
        <div class="layui-tab-item">
            <iframe id="iframe2" src="http://127.0.0.1:8023/cll" width="100%" style="border: none;"></iframe>
        </div>
    </div>
</div>
<script src="/static/js/layui-v2.6.8/layui.js"></script>
<script type="text/javascript" src="/static/js/jquery-2.1.3.js"></script>
<script src="/static/js/config.js" charset="utf-8"></script>
<script>
    // 获取iframe元素
    let myIframe1 = document.getElementById("iframe1");
    // 设置iframe的高度为浏览器窗口的高度
    myIframe1.style.height = (window.innerHeight - 55) + "px";

    let myIframe2 = document.getElementById("iframe2");
    // 设置iframe的高度为浏览器窗口的高度
    myIframe2.style.height = (window.innerHeight - 55) + "px";

    layui.use(['layer', 'laydate'], function () {
        let form = layui.form;
        let date = new Date();
        let times = 31
        let read = false
        if (date.getHours() >= 18 || date.getHours() <= 6) {
            $("body").css("background-color", "#333").css("color", "#fff")
            $(".layui-tab").css("background-color", "#333")
            form.render();
        }

        form.on('checkbox(read)', function (data) {
            read = data.elem.checked
        });

        let interval = setInterval(function () {
            if (times > 0) {
                times--;
                $("#tip-time").text(times)
            } else {
                $("#tip-last-time").text("")
                clearInterval(interval);
            }
        }, 1000);

        let item = localStorage.getItem("mail-download-read");
        if (item == "" || item == null || item == undefined) {
            let open = layer.open({
                type: 1,
                title: '<h2>使用前请先仔细阅读以下介绍</h2>',
                //closeBtn: false,
                area: ['30%', '80%'],
                shade: 0.8,
                id: 'LAY_layuipro', //设定一个id，防止重复弹出
                //btn: ['好的'],
                btnAlign: 'c',
                moveType: 1, //拖拽模式，0或者1
                content: '<div style="padding: 50px; background-color: #393D49; color: #E6E6FA;line-height: 25px;">' +
                    /*'<h2>使用前请先仔细阅读以下介绍</h2><br>' +*/
                    '<p><span style="font-weight: bold;color:#FFDAB9;">1.怎样看程序是否跑完/附件是否下载完</span></p>' +
                    '<p>- 程序控制台（启动的那个黑板板）会提示文字：所有邮件下载完成，总耗时：xxx分钟；</p>' +
                    '<p>- 只要有上面这句话显示，即表示程序已经正常执行完毕，所有附件已经下载完成，并附带显示下载附件总共消耗的时间</p>' +
                    '<p>- 如果是显示“正在解析加载中”或是“已获取到邮件”或是一直在刷新程序控制台的信息，即表示程序正在解析下载附件中，请耐心等待</p>' +
                    '<p><span style="font-weight: bold;color:#FFDAB9;">2.附件下载中途遇到错误会怎样提示</span></p>' +
                    '<p>- 下载附件途中如遇到错误，服务会记录该错误信息并继续下载后面的附件，待所有附件下载完成后会在控制台末尾显示错误信息</p>' +
                    '<p>- 错误记录从以 “以下是下载附件时记录的报错信息-开始” 开始到以 “以是上下载附件时记录的报错信息-结束” 结束</p>' +
                    '<p>- 如果在控制台未显示该字样，表示附件下载中途没有错误信息</p>' +
                    '<p><span style="font-weight: bold;color:#FFDAB9;">3.附件全部下载完成需要多久</span></p>' +
                    '<p>- 下载时间由下载的邮件数量、附件内容的大小和网络而决定</p>' +
                    '<p>- 正常网络下，一个附件下载平均速度为0.5秒；经测试，下载8000个附件的时间大约是87分钟（数据仅供参考）</p>' +
                    '<p>- 建议 如果是第一次下载（需要下载的附件较多），使用数量方式下载会比较快</p>' +
                    '<p>- 建议 如果是增量下载（只需要下载的较少的附件），使用时间方式下载会比较快</p>' +
                    '<span style="font-weight: bold;color:#FFDAB9;">4.邮箱服务器地址为必填项，常见邮箱类型服务地址请参考</span>（其它未提供的非常见邮箱地址请自行搜索查询）<br>' +
                    '      <a style="color: #00BBFF" href="https://www.youqiyi.net/article260/detail276.html" target="_blank">https://www.youqiyi.net/article260/detail276.html</a><br>' +
                    '<br>' +
                    '以上为常见且重要的信息提示，更多其它的提示信息请仔细阅读下载页的内容<br>' +
                    '<form class="layui-form">' +
                    '<input type="checkbox" name="read" value="1" lay-skin="primary" lay-filter="read" title="我已仔细阅读并知晓以上重要提示，且下次不再提醒我">' +
                    '<span id="tip-last-time" style="font-size: 14px;">浏览剩余时间：<span id="tip-time">40</span>秒</span>' +
                    '</form>' +
                    '</div>',
                cancel: function () {
                    if (times > 0) {
                        layer.msg('<span style="color: #90EE90;">以上重要信息提示还需要' + times + '秒的阅读时间，请仔细阅读以上提示</span>', {
                            time: 3000
                        });
                        return false
                    } else {
                        if (!read) {
                            layer.msg('<span style="color: #90EE90;">请勾选“我已仔细阅读并知晓以上重要提示”！</span>', {
                                time: 3000
                            });
                            return false
                        } else {
                            localStorage.setItem("mail-download-read", "true");
                        }
                    }
                }
            });
        }
    });
</script>
</body>
</html>